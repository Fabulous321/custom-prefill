<div class="multi_prefill_settings">
    <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
            <b>自定义预填充</b>
            <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">
            <!-- 全局开关 -->
            <div class="multi_prefill_block">
                <label class="checkbox_label">
                    <input id="multi_prefill_enabled" type="checkbox" checked />
                    <span>启用自定义预填充</span>
                </label>
            </div>

            <div class="multi_prefill_block">
                <label class="checkbox_label">
                    <input id="multi_prefill_custom_only" type="checkbox" checked />
                    <span>仅对 Custom API 源生效</span>
                </label>
                <small>建议开启，避免干扰其他已内置支持的 API</small>
            </div>

            <div class="multi_prefill_block">
                <label class="checkbox_label">
                    <input id="multi_prefill_variables" type="checkbox" />
                    <span>启用变量替换</span>
                </label>
                <small>允许在额外属性中使用 {{char}}、{{user}} 等变量</small>
            </div>

            <hr class="sysHR">

            <!-- 规则列表 -->
            <div class="multi_prefill_block">
                <div class="rules-header">
                    <span class="rules-title">预填充规则</span>
                    <small>根据模型名称自动匹配并应用对应的预填充属性</small>
                </div>

                <div id="multi_prefill_rules_list" class="rules-list">
                    <!-- 规则会动态渲染到这里 -->
                </div>

                <div class="rules-actions">
                    <button id="add_deepseek_rule" class="menu_button" title="添加 DeepSeek 规则">
                        <i class="fa-solid fa-plus"></i> DeepSeek
                    </button>
                    <button id="add_kimi_rule" class="menu_button" title="添加 Kimi 规则">
                        <i class="fa-solid fa-plus"></i> Kimi
                    </button>
                    <button id="add_kimi_roleplay_rule" class="menu_button" title="添加 Kimi 角色扮演规则">
                        <i class="fa-solid fa-plus"></i> Kimi 角色
                    </button>
                    <button id="add_custom_rule" class="menu_button" title="添加自定义规则">
                        <i class="fa-solid fa-plus"></i> 自定义
                    </button>
                </div>
            </div>

            <hr class="sysHR">

            <!-- 调试选项 -->
            <div class="multi_prefill_block">
                <label class="checkbox_label">
                    <input id="multi_prefill_log" type="checkbox" />
                    <span>启用调试日志</span>
                </label>
                <small>在浏览器控制台中查看详细的匹配和注入信息</small>
            </div>

            <hr class="sysHR">

            <!-- 说明 -->
            <div class="multi_prefill_info">
                <small>
                    <i class="fa-solid fa-info-circle"></i>
                    此扩展根据模型名称自动选择预填充属性：
                    <ul>
                        <li><b>DeepSeek</b>: <code>prefix: true</code></li>
                        <li><b>Kimi/Moonshot</b>: <code>partial: true</code></li>
                        <li><b>Kimi 角色扮演</b>: <code>partial: true</code> + <code>name: "{{char}}"</code></li>
                    </ul>
                    <div class="var-help">
                        <b>变量说明:</b>
                        <code>{{char}}</code> = 角色名, <code>{{user}}</code> = 用户名
                    </div>
                </small>
            </div>
        </div>
    </div>
</div>