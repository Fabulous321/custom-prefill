# 自定义预填充 (Custom Prefill)

这是一个 SillyTavern (酒馆) 扩展，为多种 LLM 模型自动添加预填充 (Prefill) 属性。

## ✨ 功能特性

- **自动识别模型**：根据模型名称自动匹配预填充规则
- **多模型支持**：内置 DeepSeek、Kimi 预设
- **额外属性**：支持 Kimi 的 `name` 字段等额外属性注入
- **变量替换**：可选的 `{{char}}`、`{{user}}` 变量替换（默认关闭）
- **可视化管理**：在酒馆设置面板中管理规则

## 📦 支持的模型

| 模型 | 预填充属性 | 匹配模式 |
| --- | --- | --- |
| DeepSeek | `prefix: true` | `deepseek` |
| Kimi | `partial: true` | `kimi\|moonshot` |
| Kimi 角色扮演 | `partial: true` + `name` | `kimi\|moonshot` |

## ⚙️ 配置说明

在 **扩展 (Extensions)** 面板中找到 **自定义预填充**：

### 全局选项

| 设置项 | 说明 |
| --- | --- |
| **启用自定义预填充** | 扩展总开关 |
| **仅对 Custom API 源生效** | 避免干扰其他已内置支持的 API |
| **启用变量替换** | 允许使用 `{{char}}`、`{{user}}` 变量 |
| **启用调试日志** | 在浏览器控制台打印详情 |

### 规则管理

- **添加预设规则**：点击对应按钮快速添加
- **编辑规则**：点击编辑按钮修改已有规则
- **额外属性**：使用 JSON 格式配置（如 `{"name": "{{char}}"}`）

## 🔧 变量说明

| 变量 | 说明 |
| --- | --- |
| `{{char}}` | 当前角色名 |
| `{{user}}` | 用户名 |
| `{{persona}}` | 用户名（同 `{{user}}`） |

> **注意**：变量替换功能默认关闭，需要在全局设置中启用，并在规则中勾选"对此规则启用变量替换"。

## 📝 更新日志

### v2.1.0

- ✨ 新增额外属性支持（如 Kimi 的 `name` 字段）
- ✨ 新增可选的变量替换功能
- ✨ 新增 Kimi 角色扮演预设
- 🎨 规则编辑功能

### v2.0.0

- 🎉 支持多模型自动匹配
- ✨ 规则管理界面

### v1.0.0

- 初始版本

## 授权协议

MIT License
